<HTML>
	<HEAD>
		<TITLE>
			DirectXSDKのプロジェクト設定方法
		</TITLE>
	</HEAD>
	<BODY bgcolor="#b8d4ef" topmargin="50" leftmargin="50" marginheight="40" marginwidth="40">
		<div align="center"><font size="7">DirectXSDKのプロジェクト設定方法</font></div>
	

		<p>
			※最終更新日：18/12/02
		</p>

		<h2>
			対象
			<hr color="#99baff">
		</h2>
		<p>
			&emsp;C言語を学び終えてC++も学び終えてDirectXの初歩を学びたい人のための環境構築講座です。<br>
			Visual Studio 2015または2017を使用しての説明となります。<br>
			<br><br><br><br><br>
		</p>

		<h2>
			目的
			<hr color="#99baff">
		</h2>
		<p>
			&emsp;上を目指す人を対象としたDirectXの設定方法を説明します。<br>
			<br><br><br><br><br>
		</p>

		<h2>
			構成
			<hr color="#99baff">
		</h2>
		<p>
			<ol>
				<a href="#R1">No.1 DX9または古い勉強サンプルで扱うためのDirectX SDKのダウンロード<br></a>
				<a href="#R2">No.2 プロジェクトの設定<br></a>
			</ol><br>
			<br><br><br><br><br>
		</p>

		<h2>
			本編
			<hr color="#99baff">
		</h2>
		<p>
			&emsp;今回はDirectXを扱うための導入について説明します。ちなみに画像を多く使って説明します。<br>
			<br><br><br><br><br>
		</p>

		<h3>
			<a name="R1">
				No.1 DX9または古い勉強サンプルで扱うためのDirectX SDKのダウンロード
			</a>
			<hr color="#99baff">
		</h3>
		<p>
			&emsp;以下のURLから<font color="red">DirectX SDK</font>をダウンロードしてください。<br>
			<br>
			&emsp;<a href="https://www.microsoft.com/en-us/download/details.aspx?id=6812">Download DirectX Software Development Kit from Official Microsoft Download Center</a><br>
			<br>
			&emsp;というサイトへ移動してください。以下のようなサイトへ移ると思います。<br>
			違うようなサイトもしくはサイトがなかった場合は「DirectX SDK ダウンロード」と検索してダウンロードしてください。<br>
			<img src="1.jpg" alt="Download DirectX Software Development Kit from Official Microsoft Download Center"><br>
			<br>
			&emsp;そのサイトにある「Download」を押して始めてください。以下は画像で説明します。<br>
			<br>
			<img src="2.jpg" alt="Download"><br>
			<br>
			<img src="3.jpg" alt="exeをダウンロード"><br>
			<br>
			<img src="4.jpg" alt="exeを起動"><br>
			<br>
			<img src="5.jpg" alt="SDKのダウンロード最初"><br>
			<br>
			<img src="6.jpg" alt="使用許諾契約"><br>
			<br>
			<img src="7.jpg" alt="ヘルプを入れるか入れないか"><br>
			<br>
			<img src="8.jpg" alt="インストールフォルダ"><br>
			<br><br><br>
			&emsp;ダウンロード済みなのでここからは端折りますが次へなどあればそのまま進んでください。<br>
			ダウンロードが終わりますと以下のディレクトリに<font color="red">Microsoft DirectX SDK(June 2010)</font>があるはずなので確認してください。<br>
			<br><br>
			<img src="9.jpg" alt="SDKフォルダの確認"><br>
			<br>
			<br>
			&emsp;これでダウンロードは終了です。<br>
			<br><br><br><br><br>
		</p>

		

		<h3>
			<a name="R2">
				No.2 プロジェクトの設定
			</a>
			<hr color="#99baff">
		</h3>
		<p>
			&emsp;以下のサイトで勉強してください。私も最初はこのページからDirectXを始めましたし最初としてはいいサイトだと思います。<br><br>
			&emsp;<a href="http://k3tec.net/neko_wiki/index.php?DirectX%B9%D6%BA%C20%B2%F3">DirectX講座0回 - K3 計算技術研究会</a><br><br>
			&emsp;ですがバージョンや環境の古さが相まって大変なことになると思いましたのでダウンロードを設けました。<br>
			DxLib同様DirectXにもプロジェクトの設定がいりますのでそれだけでも説明しようと思います。<br>
			ですが、上のリンクのページでそれらを学ぶのはありです。<br>
			また、先に話しますとこのサイトではDirectX SDKの導入の説明しかしておらずWindows SDKの説明はしていません。なぜ、私は導入をさせたか。なぜ、このサイトでは一切触れていないか。
			疑問に感じると思いますので軽く説明しようと思いますが、とりあえずこのNo.3の目的を完遂したいので後で説明します。<br>
			<br><br>
			&emsp;まず、Visual Studioを起動して新しいプロジェクトを作成してmain.cppを表示したところまでやってください。
			お伝えしなおしますが今ページはC言語及びC++の最低限を学び終えDxLibでゲームを作成したことがある人が対象です。<br>
			<br>
			プロジェクトの設定なので画像で簡単に説明します。<br>
			<br><br>
			<img src="10.jpg" alt="x64へ変更"><br>
			<br>
			<img src="12.jpg" alt="VC++ディレクトリの設定前確認"><br>
			<br>
			<img src="14.jpg" alt="インクルードディレクトリのDirectX SDKの設定"><br>
			<br>
			<img src="15.jpg" alt="インクルードディレクトリの設定後"><br>
			<br>
			<img src="23.jpg" alt="ライブラリディレクトリのDirectXSDKの設定"><br>
			<br>
			<img src="24.jpg" alt="ライブラリディレクトリの設定後"><br>
			<br><br>
			これで初期設定は終了です。<br>
			<br>
			&emsp;それで設定がうまくいってるのかを確認するために以下のコードをひとまずコピペでテストしてください。<br>
			今は特に勉強してない段階、ただの設定の段階なので中身は無視しますがこの設定を終えたら中身の意味を全部理解してもらいます。<br>
			<br><br><br><br>
			FireFoxを想定して記述したのでコードがはみ出る場合はhtmlから直接コピペしてください。
		</p>
		<div style="background:#EFEFEF;width:1200px;border:1px solid #CC0000; height:2500px;">
		<pre>
	// Direct3Dに必要なヘッダーとライブラリ

	#define D3D_DEBUG_INFO	// Direct3Dデバックフラグ
			
	#pragma comment(lib, &quot;d3d9.lib&quot;)
	#pragma comment(lib, &quot;d3dx9.lib&quot;)
	#pragma comment(lib, &quot;d3dxof.lib&quot;)
	#pragma comment(lib, &quot;dxguid.lib&quot;)
	#pragma comment(lib, &quot;winmm.lib&quot;)
	#include &lt;comdef.h&gt;
	#include &lt;d3d9.h&gt;
	#include &lt;d3dx9.h&gt;
	#include &lt;mmsystem.h&gt;

	#include &lt;Windows.h&gt;
	#include &lt;tchar.h&gt;
			
	// ウィンドウプロシージャ、ウィンドウに対するメッセージ処理を行う
	LRESULT CALLBACK WndProc(HWND hWnd, UINT msg, WPARAM wParam, LPARAM lParam){
		
		switch(msg){
			// ウィンドウが破棄されたとき
			case WM_DESTROY:
				PostQuitMessage(0);	// WM_QUITメッセージをメッセージキューに送る
				return 0;
		}
		// デフォルトのメッセージ処理を行う
		return DefWindowProc(hWnd, msg, wParam, lParam);
	}
			
	// WinMain関数（アプリケーションの開始関数）
	// コンソールアプリケーションと違い、コンソールを開かない
	int _stdcall WinMain(HINSTANCE hInstance,HINSTANCE hPrevInstance,LPSTR lpCmdLine,int nCmdShow)
	{
		const TCHAR* WC_BASIC = _T(&quot;BASIC_WINDOW&quot;);
		// シンプルウィンドウクラス設定
		WNDCLASSEX wcex ={sizeof(WNDCLASSEX), CS_HREDRAW | CS_VREDRAW | CS_DBLCLKS,WndProc, 0,0,hInstance,
			(HICON)LoadImage(NULL,MAKEINTRESOURCE(IDI_APPLICATION),IMAGE_ICON,0,0,LR_DEFAULTSIZE | LR_SHARED),
			(HCURSOR)LoadImage(NULL,MAKEINTRESOURCE(IDC_ARROW),IMAGE_CURSOR,0,0,LR_DEFAULTSIZE | LR_SHARED), 
			(HBRUSH)GetStockObject(WHITE_BRUSH), NULL, WC_BASIC , NULL};
			
		// シンプルウィンドウクラス作成
		if(!RegisterClassEx(&amp;wcex)) 
			return false;
			
		// ウィンドウ幅、高さはディスプレイに依存する。普通は4:3
		const int WINDOW_WIDTH = 640;
		const int WINDOW_HEIGHT = 480;
		// ウィンドウの作成
		HWND hWnd = CreateWindowEx(0,WC_BASIC,
			_T(&quot;Application&quot;), WS_OVERLAPPEDWINDOW | WS_CLIPCHILDREN | WS_VISIBLE,
			CW_USEDEFAULT,CW_USEDEFAULT,WINDOW_WIDTH,WINDOW_HEIGHT,NULL,NULL,hInstance,NULL);
			
		//      Direct3Dの初期化
			
		IDirect3D9*		pD3D9 = NULL;		// Direct3Dデバイス生成用オブジェクト
		IDirect3DDevice9*	pDevice3D = NULL;	// Direct3Dのデバイス
			
		// Direct3D9オブジェクトの作成	
		pD3D9 = Direct3DCreate9(D3D_SDK_VERSION);	
		// ディスプレイ情報取得
		D3DDISPLAYMODE Display;
		pD3D9-&gt;GetAdapterDisplayMode( D3DADAPTER_DEFAULT, &amp;Display);
			
		D3DPRESENT_PARAMETERS	D3DParam = {			// スワップチェイン設定
			WINDOW_WIDTH,WINDOW_HEIGHT,Display.Format,1,D3DMULTISAMPLE_NONE,0,
			D3DSWAPEFFECT_DISCARD,hWnd,TRUE,TRUE,D3DFMT_D24S8,0,0,D3DPRESENT_INTERVAL_DEFAULT
		};			
		// HALモードで3Dデバイス作成
		if (FAILED(pD3D9-&gt;CreateDevice(D3DADAPTER_DEFAULT,D3DDEVTYPE_HAL, D3DParam.hDeviceWindow,
			D3DCREATE_HARDWARE_VERTEXPROCESSING | D3DCREATE_MULTITHREADED, &amp;D3DParam, &amp;pDevice3D)))
		if (FAILED(pD3D9-&gt;CreateDevice(D3DADAPTER_DEFAULT, D3DDEVTYPE_HAL, D3DParam.hDeviceWindow,
			D3DCREATE_MIXED_VERTEXPROCESSING | D3DCREATE_MULTITHREADED, &amp;D3DParam, &amp;pDevice3D)))
		// REFモードで3Dデバイス作成
		if (FAILED(pD3D9-&gt;CreateDevice(D3DADAPTER_DEFAULT, D3DDEVTYPE_REF, D3DParam.hDeviceWindow, 
			D3DCREATE_HARDWARE_VERTEXPROCESSING | D3DCREATE_MULTITHREADED, &amp;D3DParam, &amp;pDevice3D)))
		if (FAILED(pD3D9-&gt;CreateDevice(D3DADAPTER_DEFAULT, D3DDEVTYPE_REF, D3DParam.hDeviceWindow, 
			D3DCREATE_SOFTWARE_VERTEXPROCESSING | D3DCREATE_MULTITHREADED, &amp;D3DParam, &amp;pDevice3D)))
		{
			// 3Dデバイス作成失敗
			pD3D9-&gt;Release();
			return -1;
		}
			
		// メッセージループ
		MSG msg = {}; 
		while(msg.message != WM_QUIT) {
			// アプリケーションに送られてくるメッセージをメッセージキューから取得する
			if(PeekMessage(&amp;msg, NULL, 0, 0, PM_REMOVE)){
				DispatchMessage(&amp;msg);	// アプリケーションの各ウィンドウプロシージャにメッセージを転送する
			}
			// メッセージ処理をしていないとき
			else{
			//（ここにDirectXの処理を書く）
			
				// 描画開始
				if(SUCCEEDED(pDevice3D-&gt;BeginScene()))
				{
					DWORD ClearColor = 0xff808080;	// 背景クリア色
					// 背景クリア
					pDevice3D-&gt;Clear( 0, NULL, D3DCLEAR_TARGET | D3DCLEAR_STENCIL | D3DCLEAR_ZBUFFER, ClearColor, 1.0f, 0 );
				
					// 描画終了
					pDevice3D-&gt;EndScene();
				}
				// 描画反映
				pDevice3D-&gt;Present( NULL, NULL, NULL, NULL );
				}
			}
			// DirectXの変数は必ず後処理をすること
			pDevice3D-&gt;Release();
			pD3D9-&gt;Release();	
			return 0;
		}
		</pre>
		</div>
		<p>
			<br>
			&emsp;エラーなく実行できていれば設定はちゃんとできています。エラーが出た場合は何かしらでミスっています。<br>
			<br>
			<br>
			&emsp;以上で今回の説明は以上となります。<br>
		</p>
	</BODY>
</HTML>